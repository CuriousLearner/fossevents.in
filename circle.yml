machine:
  python:
    version: 2.7.11
  environment:
    DJANGO_SETTINGS_MODULE: "settings.local"
    DATABASE_URL: "postgres://ubuntu@localhost/circle_test"

dependencies:
  override:
    - pip install pip-accel
    - pip-accel install -r requirements/development.txt
  # cache_directories:
  #   - "~/.cache/pip"
  #   - "~/.pip-accel"

test:
  override:
    - flake8
    - coverage run --source='fossevents' --omit='*tests*,*requirements*,*commands*,*migrations*,*admin*,*wsgi*' -m py.test --junitxml=$CIRCLE_TEST_REPORTS/summary.xml -v --tb=native
    - coverage html -d $CIRCLE_ARTIFACTS
